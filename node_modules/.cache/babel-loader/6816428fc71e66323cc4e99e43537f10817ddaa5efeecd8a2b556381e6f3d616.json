{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useSelector,useDispatch}from'react-redux';import{Button,Form,Input,Upload,List,Tag,Flex}from'antd';import{UploadOutlined}from'@ant-design/icons';import{DragDropContext,Droppable,Draggable}from'react-beautiful-dnd';import{updateMediaOrder}from'./ducks/slice';import{mediaList as mediaThunk,mediaUpload}from'./ducks/thunks';import{useNavigate}from'react-router-dom';import{logout}from'modules/auth/ducks/slice';import MediaViewModal from'./ViewMediaModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MediaPage=()=>{const dispatch=useDispatch();const navigate=useNavigate();const[fileList,setFileList]=useState([]);const[selectedMedia,setSelectedMedia]=useState(null);const[form]=Form.useForm();const{mediaList,error}=useSelector(state=>state.media);useEffect(()=>{dispatch(mediaThunk());},[dispatch]);const handleUpload=async values=>{if(fileList.length===0){console.error('No file selected');return;}const formData=new FormData();const file=fileList[0].originFileObj;formData.append('file',file);formData.append('tags',values.tags);formData.append('filetype',file.type);const resultAction=dispatch(mediaUpload(formData));if(mediaUpload.fulfilled.match(resultAction)){dispatch(mediaThunk());form.resetFields();setFileList([]);}};const handleFileChange=_ref=>{let{fileList}=_ref;setFileList(fileList);};const handleDragEnd=result=>{if(!result.destination)return;const reorderedItems=Array.from(mediaList);const[movedItem]=reorderedItems.splice(result.source.index,1);reorderedItems.splice(result.destination.index,0,movedItem);dispatch(updateMediaOrder(reorderedItems));};const handleLogout=()=>{dispatch(logout());navigate('/login');};return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:800,margin:'0 auto',padding:'20px'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Media Management\"}),/*#__PURE__*/_jsx(Flex,{children:/*#__PURE__*/_jsx(Button,{type:\"link\",htmlType:\"button\",onClick:handleLogout,children:\"logout\"})}),/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:handleUpload,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"file\",label:\"Upload Media\",rules:[{required:true,message:'Please upload a media file'}],children:/*#__PURE__*/_jsx(Upload,{beforeUpload:()=>false,fileList:fileList,onChange:handleFileChange,maxCount:1,children:/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(UploadOutlined,{}),children:\"Select File\"})})}),/*#__PURE__*/_jsx(Form.Item,{name:\"tags\",label:\"Tags\",rules:[{required:true,message:'Please add tags'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"Enter comma-separated tags\"})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Upload\"})})]}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:handleDragEnd,children:/*#__PURE__*/_jsx(Droppable,{droppableId:\"media-list\",children:provided=>/*#__PURE__*/_jsxs(\"div\",{...provided.droppableProps,ref:provided.innerRef,children:[mediaList.map((item,index)=>/*#__PURE__*/_jsx(Draggable,{draggableId:item.id.toString(),index:index,children:provided=>{var _item$Tags;return/*#__PURE__*/_jsxs(Flex,{ref:provided.innerRef,...provided.draggableProps,...provided.dragHandleProps,justify:\"space-between\",children:[/*#__PURE__*/_jsx(Flex,{children:item.filename}),/*#__PURE__*/_jsx(Flex,{children:(_item$Tags=item.Tags)===null||_item$Tags===void 0?void 0:_item$Tags.map((tag,index)=>/*#__PURE__*/_jsx(Tag,{color:\"blue\",children:tag===null||tag===void 0?void 0:tag.tag},index))}),/*#__PURE__*/_jsx(Flex,{children:/*#__PURE__*/_jsx(Button,{type:\"link\",htmlType:\"button\",onClick:()=>{setSelectedMedia(item.id);},children:\"View\"})})]});}},item.id)),provided.placeholder]})})}),/*#__PURE__*/_jsx(MediaViewModal,{mediaId:selectedMedia,visible:selectedMedia,onClose:()=>{setSelectedMedia(null);}})]});};export default MediaPage;","map":{"version":3,"names":["React","useEffect","useState","useSelector","useDispatch","Button","Form","Input","Upload","List","Tag","Flex","UploadOutlined","DragDropContext","Droppable","Draggable","updateMediaOrder","mediaList","mediaThunk","mediaUpload","useNavigate","logout","MediaViewModal","jsx","_jsx","jsxs","_jsxs","MediaPage","dispatch","navigate","fileList","setFileList","selectedMedia","setSelectedMedia","form","useForm","error","state","media","handleUpload","values","length","console","formData","FormData","file","originFileObj","append","tags","type","resultAction","fulfilled","match","resetFields","handleFileChange","_ref","handleDragEnd","result","destination","reorderedItems","Array","from","movedItem","splice","source","index","handleLogout","style","maxWidth","margin","padding","children","htmlType","onClick","layout","onFinish","Item","name","label","rules","required","message","beforeUpload","onChange","maxCount","icon","placeholder","color","onDragEnd","droppableId","provided","droppableProps","ref","innerRef","map","item","draggableId","id","toString","_item$Tags","draggableProps","dragHandleProps","justify","filename","Tags","tag","mediaId","visible","onClose"],"sources":["/Users/adeelakram/Documents/projects/freelance/mediaUploadFE/src/modules/mediaFiles/Media.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Button, Form, Input, Upload, List, Tag, Flex } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport { updateMediaOrder } from './ducks/slice';\nimport { mediaList as mediaThunk, mediaUpload } from './ducks/thunks';\nimport { useNavigate } from 'react-router-dom';\nimport { logout } from 'modules/auth/ducks/slice';\nimport MediaViewModal from './ViewMediaModal';\n\nconst MediaPage = () => {\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const [fileList, setFileList] = useState([]);\n  const [selectedMedia, setSelectedMedia] = useState(null);\n  const [form] = Form.useForm(); \n  const { mediaList, error } = useSelector((state) => state.media);\n\n  useEffect(() => {\n    dispatch(mediaThunk());\n  }, [dispatch]);\n\n\n  const handleUpload = async (values) => {\n    if (fileList.length === 0) {\n      console.error('No file selected');\n      return;\n    }\n\n    const formData = new FormData();\n    const file = fileList[0].originFileObj;\n    formData.append('file', file);\n    formData.append('tags', values.tags);\n    formData.append('filetype', file.type);\n    const resultAction = dispatch(mediaUpload(formData));\n    if (mediaUpload.fulfilled.match(resultAction)) {\n      dispatch(mediaThunk());\n      form.resetFields();\n      setFileList([]);\n    }\n  };\n\n\n  const handleFileChange = ({ fileList }) => {\n    setFileList(fileList);\n  };\n \n  const handleDragEnd = (result) => {\n    if (!result.destination) return;\n    const reorderedItems = Array.from(mediaList);\n    const [movedItem] = reorderedItems.splice(result.source.index, 1);\n    reorderedItems.splice(result.destination.index, 0, movedItem);\n    dispatch(updateMediaOrder(reorderedItems));\n  };\n  const handleLogout = () => {\n    dispatch(logout());\n    navigate('/login');\n  }\n\n  return (\n    <div style={{ maxWidth: 800, margin: '0 auto', padding: '20px' }}>\n      <h2>Media Management</h2>\n      <Flex>\n        <Button type=\"link\" htmlType=\"button\" onClick={handleLogout}>\n            logout\n          </Button>\n      </Flex>\n      \n      <Form form={form} layout=\"vertical\" onFinish={handleUpload}>\n        <Form.Item\n          name=\"file\"\n          label=\"Upload Media\"\n          rules={[{ required: true, message: 'Please upload a media file' }]}\n        >\n          <Upload\n            beforeUpload={() => false}\n            fileList={fileList}\n            onChange={handleFileChange}\n            maxCount={1}\n          >\n            <Button icon={<UploadOutlined />}>Select File</Button>\n          </Upload>\n        </Form.Item>\n        <Form.Item\n          name=\"tags\"\n          label=\"Tags\"\n          rules={[{ required: true, message: 'Please add tags' }]}\n        >\n          <Input placeholder=\"Enter comma-separated tags\" />\n        </Form.Item>\n        <Form.Item>\n          <Button type=\"primary\" htmlType=\"submit\">\n            Upload\n          </Button>\n        </Form.Item>\n      </Form>\n\n      {error && <p style={{ color: 'red' }}>{error}</p>}\n\n      <DragDropContext onDragEnd={handleDragEnd}>\n        <Droppable droppableId=\"media-list\">\n          {(provided) => (\n            <div\n              {...provided.droppableProps}\n              ref={provided.innerRef}\n            >\n              {mediaList.map((item, index) => (\n                <Draggable key={item.id} draggableId={item.id.toString()} index={index}>\n                  {(provided) => (\n                    <Flex\n                      ref={provided.innerRef}\n                      {...provided.draggableProps}\n                      {...provided.dragHandleProps} \n                      justify='space-between'\n                    >\n                      <Flex>{item.filename}</Flex>\n                      <Flex>{item.Tags?.map((tag, index) => (\n                          <Tag color=\"blue\" key={index}>\n                            {tag?.tag}\n                          </Tag>\n                        ))}\n                      </Flex>\n                      <Flex>\n                      <Button type=\"link\" htmlType=\"button\" onClick={() => {setSelectedMedia(item.id)}}>\n                        View\n                      </Button>\n                      </Flex>\n                    </Flex>\n                  )}\n                </Draggable>\n              ))}\n              {provided.placeholder}\n            </div>\n          )}\n        </Droppable>\n      </DragDropContext>\n      <MediaViewModal mediaId={selectedMedia} visible={selectedMedia} onClose={() => {setSelectedMedia(null)} } />\n    </div>\n  );\n};\n\nexport default MediaPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}